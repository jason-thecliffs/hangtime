================================================================================
HangTime Migration: Replit → GitHub + Railway
================================================================================
Last Updated: 2026-01-22 (deployment completed)

OVERVIEW
--------
Migrate HangTime from Replit to a standalone GitHub + Railway deployment.
Strategy: Modify local codebase, push to GitHub, deploy to Railway with its own PostgreSQL.

================================================================================
PHASE 1: Remove Replit-Specific Code                                  [COMPLETE]
================================================================================
[x] client/index.html - Removed Replit banner script (lines 11-12)
[x] vite.config.ts - Removed Replit plugins (import and plugin usage)
[x] server/index.ts - Made PORT configurable via environment variable

================================================================================
PHASE 2: Switch from Neon to Standard PostgreSQL                      [COMPLETE]
================================================================================
[x] package.json - Removed @neondatabase/serverless, added pg
[x] package.json - Removed Replit devDependencies, added @types/pg
[x] server/db.ts - Rewrote to use standard pg Pool with drizzle-orm/node-postgres

================================================================================
PHASE 3: Create New Files                                             [COMPLETE]
================================================================================
[x] .gitignore - Created with node_modules, dist, .env, .replit, etc.
[x] .env.example - Created with DATABASE_URL, NODE_ENV, PORT
[x] railway.toml - Created with build/deploy configuration
[x] .github/workflows/ci.yml - Created with build/check/test pipeline

================================================================================
PHASE 4: Local Verification                                           [COMPLETE]
================================================================================
[x] Run: npm install (to update node_modules with pg instead of neon)
[x] Run: npm run check (TypeScript type checking)
    - Fixed 2 pre-existing TS errors:
      - server/vite.ts: allowedHosts type (added `as const`)
      - client/src/pages/edit-event.tsx: null→undefined conversion
[x] Run: npm run build (production build test)
[ ] (Optional) Test with a local PostgreSQL DATABASE_URL if available

================================================================================
PHASE 5: Git & GitHub                                                 [COMPLETE]
================================================================================
[x] git init
[x] git add . (excluding .claude/, replit.md)
[x] git commit -m "Initial commit: HangTime scheduler (standalone)"
[x] Create repo on GitHub: https://github.com/jason-thecliffs/hangtime
[x] git push -u origin main
    Note: CI workflow (.github/workflows/ci.yml) not pushed due to token scope.
    File exists locally - can be added via GitHub web UI if needed.

================================================================================
PHASE 6: Deploy to Railway                                            [COMPLETE]
================================================================================
[x] Create new project on railway.app
[x] Add PostgreSQL service
[x] Set environment variables: NODE_ENV=production, DATABASE_URL
[x] Deploy app service linked to GitHub repo
[x] Database schema pushed via: npm run db:push

App URL: https://hangtime-app-production.up.railway.app
Railway Project: https://railway.com/project/02eb2c38-977d-4866-a016-aab6fc59da30

Additional fixes made during deployment:
- Fixed pg import for ESM compatibility (default import pattern)
- Added .node-version file to specify Node 20

================================================================================
PHASE 7: Verification Testing                                         [PARTIAL]
================================================================================
[x] Home page - Visit Railway URL, verify HangTime loads (HTTP 200)
[ ] Create event - Create new event, verify success
[ ] Share link - Copy share link, verify it works
[ ] Participate - Submit availability, verify response saved
[ ] View results - Check event page, verify all responses visible

================================================================================
FILES MODIFIED
================================================================================
- client/index.html      → Removed Replit banner
- vite.config.ts         → Removed Replit plugins
- package.json           → Swapped Neon→pg, removed Replit deps
- server/index.ts        → Made PORT configurable
- server/db.ts           → Rewrote for standard PostgreSQL (also fixed ESM import)
- server/vite.ts         → Fixed allowedHosts type (added `as const`)
- client/src/pages/edit-event.tsx → Fixed null→undefined for description
- .gitignore             → Added .claude/ directory

================================================================================
FILES CREATED
================================================================================
- .gitignore
- .env.example
- railway.toml
- .github/workflows/ci.yml (exists locally, not in GitHub due to token scope)
- .node-version          → Specifies Node 20 for Railway
- MIGRATION_PROGRESS.txt (this file)

================================================================================
NOTES
================================================================================
- Replit app remains unchanged and running during transition
- Railway database will be fresh (no data migration)
- If Railway fails, Replit continues working as fallback
- Local git history allows reverting any changes

================================================================================
NEXT STEPS
================================================================================
1. [DONE] All deployment steps completed
2. Test the app manually at: https://hangtime-app-production.up.railway.app
3. Optional: Add the CI workflow to GitHub (couldn't push due to token scope)

================================================================================
DEPLOYMENT SUMMARY
================================================================================
- GitHub Repo: https://github.com/jason-thecliffs/hangtime
- Railway App: https://hangtime-app-production.up.railway.app
- Railway Dashboard: https://railway.com/project/02eb2c38-977d-4866-a016-aab6fc59da30
- Replit app remains unchanged as fallback
